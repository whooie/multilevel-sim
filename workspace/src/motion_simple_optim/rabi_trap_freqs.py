from pathlib import Path
import numpy as np
import whooie.pyplotdefs as pd

outdir = Path("output")

class Data:
    # kHz
    trap_freq: float
    # [ rabi [kHz], th0, ph0, th1, ph1, th2, ph2, fidelity, time [ms] ]
    data: np.ndarray[float, 2]

    def __init__(self, trap_freq: float, *rows: list[float]):
        self.trap_freq = trap_freq
        self.data = np.array(rows)

# gate_name = "e-m_swap"
# data = [
#     Data(
#         10.0,
#         [ 0.03, 3.665, 4.668, 5.864, 6.078, 3.665, 4.773, 0.999213, 139.979 ],
#         [ 0.05, 1.467, 1.511, 1.477, 5.945, 1.456, 1.413, 0.999459,  28.008 ],
#         [ 0.10, 1.447, 1.500, 1.486, 5.925, 1.458, 1.450, 0.997521,  13.976 ],
#         [ 0.30, 3.683, 0.311, 3.683, 4.730, 1.484, 6.015, 0.997751,   9.391 ],
#         [ 0.50, 3.666, 0.386, 1.468, 4.812, 3.666, 5.852, 0.986236,   5.602 ],
#         [ 1.00, 3.124, 4.535, 4.499, 1.105, 5.873, 1.684, 0.981859,   4.296 ],
#         [ 3.00, 5.893, 1.492, 4.297, 2.558, 5.861, 3.379, 0.908941,   1.703 ],
#         [ 5.00, 4.058, 1.309, 3.142, 0.393, 4.058, 5.890, 0.763539,   0.712 ],
#     ),
#     Data(
#         30.0,
#         [ 0.03, 2.241, 4.051, 2.241, 2.255, 2.241, 4.041, 0.999927,  71.334 ],
#         [ 0.05, 2.247, 4.064, 2.248, 2.266, 2.248, 4.032, 0.999892,  42.925 ],
#         [ 0.10, 2.239, 4.066, 2.239, 2.249, 2.239, 4.031, 0.999488,  21.377 ],
#         [ 0.30, 3.685, 2.794, 4.806, 4.718, 5.898, 0.258, 0.998995,  15.267 ],
#         [ 0.50, 3.651, 3.695, 4.808, 5.816, 5.888, 1.565, 0.996227,   9.133 ],
#         [ 1.00, 5.927, 1.409, 5.927, 4.776, 4.827, 5.996, 0.976664,   5.309 ],
#         [ 3.00, 1.796, 5.709, 5.224, 1.298, 1.796, 3.159, 0.963640,   0.935 ],
#         [ 5.00, 0.396, 2.433, 3.832, 3.860, 0.396, 5.149, 0.956686,   0.294 ],
#     ),
#     Data(
#         50.0,
#         [ 0.03, 2.832, 4.052, 2.832, 2.261, 2.832, 4.035, 0.999977,  90.137 ],
#         [ 0.05, 2.838, 4.057, 2.837, 2.266, 2.838, 4.028, 0.999919,  54.194 ],
#         [ 0.10, 2.817, 4.078, 2.817, 2.250, 2.817, 4.019, 0.999629,  26.899 ],
#         [ 0.30, 4.795, 2.614, 4.795, 2.793, 2.596, 4.879, 0.992998,  12.929 ],
#         [ 0.50, 2.527, 1.382, 4.726, 5.991, 4.727, 3.706, 0.995657,   7.626 ],
#         [ 1.00, 1.503, 1.545, 5.901, 3.711, 1.503, 2.513, 0.986065,   2.835 ],
#         [ 3.00, 0.370, 1.132, 4.951, 6.039, 4.951, 1.340, 0.973762,   1.090 ],
#         [ 5.00, 5.884, 1.346, 5.884, 5.037, 2.742, 5.791, 0.975629,   0.924 ],
#     ),
#     Data(
#         70.0,
#         [ 0.05, 5.958, 0.393, 5.958, 0.393, 4.584, 0.393, 0.998330, 105.043 ],
#         [ 0.10, 5.958, 3.107, 5.958, 3.123, 4.584, 3.197, 0.998226,  52.524 ],
#         [ 0.30, 3.739, 4.513, 3.739, 2.240, 2.987, 3.600, 0.999631,  11.104 ],
#         [ 0.50, 5.816, 5.994, 5.816, 5.906, 4.878, 0.283, 0.998678,  10.510 ],
#         [ 1.00, 4.768, 4.775, 5.868, 5.935, 5.868, 5.858, 0.993260,   5.253 ],
#         [ 3.00, 4.049, 5.889, 5.882, 3.141, 4.966, 3.135, 0.970902,   1.581 ],
#         [ 5.00, 4.329, 5.083, 5.122, 4.161, 5.907, 5.327, 0.977705,   0.978 ],
#     ),
#     Data(
#         90.0,
#         [ 0.10, 3.188, 0.463, 4.533, 1.798, 4.533, 5.787, 0.997471,  39.008 ],
#         [ 0.30, 3.237, 0.472, 4.632, 1.787, 4.495, 5.788, 0.998671,  13.117 ],
#         [ 0.50, 3.454, 2.047, 6.203, 0.319, 6.203, 4.310, 0.989785,  10.096 ],
#         [ 1.00, 1.247, 0.294, 6.009, 1.371, 4.539, 3.185, 0.977614,   3.754 ],
#         [ 3.00, 3.127, 1.099, 4.985, 5.223, 5.963, 4.017, 0.990229,   1.493 ],
#         [ 5.00, 3.145, 3.816, 5.207, 5.729, 5.893, 0.537, 0.983858,   0.907 ],
#     ),
#     Data(
#         100.0,
#         [ 0.30, 3.391, 0.483, 4.766, 1.782, 4.766, 5.786, 0.998754,  13.711 ],
#         [ 0.50, 4.708, 2.568, 4.834, 0.306, 3.310, 1.594, 0.998178,   8.182 ],
#         [ 1.00, 4.060, 6.071, 4.060, 1.299, 4.060, 5.720, 0.983666,   3.877 ],
#         [ 3.00, 4.432, 5.783, 6.003, 0.567, 2.076, 2.676, 0.979986,   1.327 ],
#         [ 5.00, 3.141, 5.881, 5.203, 1.867, 5.890, 2.367, 0.982326,   0.906 ],
#     ),
#     Data(
#         200.0,
#         [ 0.30, 5.002, 1.317, 6.102, 2.710, 6.102, 0.446, 0.999582,  18.256 ],
#         [ 0.50, 4.964, 4.647, 5.959, 6.006, 6.019, 3.722, 0.997942,  10.779 ],
#         [ 1.00, 5.264, 3.577, 6.175, 4.838, 6.121, 2.661, 0.992707,   5.618 ],
#         [ 3.00, 3.305, 2.884, 3.315, 1.216, 4.221, 6.245, 0.982649,   1.149 ],
#         [ 5.00, 3.827, 2.277, 3.042, 1.178, 3.827, 6.362, 0.977452,   0.681 ],
#     ),
#     Data(
#         400.0,
#         [ 0.50, 5.637, 3.373, 5.633, 1.594, 5.648, 6.107, 0.980870,  10.770 ],
#         [ 1.00, 5.934, 2.749, 5.997, 4.697, 5.962, 0.326, 0.971834,   5.696 ],
#         [ 3.00, 4.978, 2.989, 4.978, 1.219, 5.895, 6.120, 0.983444,   1.682 ],
#         [ 5.00, 5.350, 4.992, 4.413, 3.552, 5.185, 2.056, 0.986337,   0.952 ],
#     ),
#     Data(
#         800.0,
#         [ 0.50, 4.943, 5.885, 4.943, 5.901, 0.538, 2.676, 0.947319,   6.636 ],
#         [ 1.00, 4.932, 4.741, 4.932, 4.788, 0.522, 1.540, 0.947729,   3.306 ],
#         [ 3.00, 5.887, 1.382, 3.687, 1.478, 0.389, 3.815, 0.946295,   1.057 ],
#         [ 5.00, 5.863, 5.947, 2.198, 3.142, 5.863, 0.337, 0.947984,   0.886 ],
#     ),
#     Data(
#         1000.0,
#         [ 0.50, 5.892, 5.890, 4.792, 5.892, 0.390, 2.592, 0.947445,   7.050 ],
#         [ 1.00, 5.890, 5.890, 4.791, 5.890, 0.393, 2.592, 0.947734,   3.640 ],
#         [ 3.00, 0.362, 3.628, 5.860, 5.865, 4.760, 5.987, 0.947199,   1.165 ],
#         [ 5.00, 5.948, 5.885, 4.115, 6.157, 0.450, 0.115, 0.947144,   0.669 ],
#     ),
# ]

# gate_name = "e-m_shelve"
# data = [
#     Data(
#         10.0,
#         [ 0.03, 4.071, 6.141, 3.156, 2.147, 3.144, 3.266, 0.988499, 110.039 ],
#         [ 0.05, 4.063, 6.170, 3.146, 2.159, 3.146, 3.305, 0.990121,  65.927 ],
#         [ 0.10, 4.042, 6.031, 3.119, 2.052, 3.151, 3.106, 0.991829,  32.825 ],
#         [ 0.30, 2.216, 1.356, 5.879, 5.900, 5.880, 2.228, 0.993386,  14.829 ],
#         [ 0.50, 2.232, 0.310, 2.232, 4.164, 2.202, 2.258, 0.992572,   4.243 ],
#         [ 1.00, 3.135, 5.037, 3.823, 5.572, 1.074,-0.126, 0.992662,   2.557 ],
#         [ 3.00, 1.751, 1.672, 4.500, 1.207, 3.133, 1.119, 0.939061,   0.996 ],
#     ),
#     Data(
#         30.0,
#         [ 0.03, 0.326, 3.560, 4.724, 1.719, 1.425, 6.228, 0.992647,  68.696 ],
#         [ 0.05, 1.352, 5.790, 4.974, 3.896, 0.399, 1.440, 0.997899,  42.810 ],
#         [ 0.10, 1.352, 5.785, 4.974, 3.891, 0.399, 1.446, 0.998305,  21.405 ],
#         [ 0.30, 1.367, 5.718, 4.991, 3.767, 0.415, 1.328, 0.998572,   7.186 ],
#         [ 0.50, 1.350, 5.599, 4.972, 3.514, 0.397, 1.047, 0.995864,   4.277 ],
#         [ 1.00, 2.675, 5.225, 5.817, 1.372, 0.319, 0.261, 0.993674,   2.805 ],
#         [ 3.00, 0.379, 2.801, 0.379, 4.452, 3.524, 0.321, 0.968434,   0.545 ],
#         [ 5.00, 3.167, 1.734, 0.418, 0.727, 1.793, 1.604, 0.959362,   0.342 ],
#     ),
#     Data(
#         50.0,
#         [ 0.03, 1.562, 5.492, 5.184, 3.124, 0.609, 2.756, 0.975499,  78.037 ],
#         [ 0.05, 0.543, 4.037, 6.185, 1.868, 1.866, 6.402, 0.986389,  54.708 ],
#         [ 0.10, 1.578, 5.642, 5.200, 3.422, 0.624, 2.995, 0.982959,  23.561 ],
#         [ 0.30, 5.946, 3.281, 4.113, 2.370, 5.946, 4.124, 0.994772,  16.981 ],
#         [ 0.50, 5.940, 3.271, 4.108, 2.264, 5.940, 3.994, 0.996432,  10.179 ],
#         [ 1.00, 4.321, 2.204, 2.750, 3.972, 2.750, 1.704, 0.997159,   3.126 ],
#         [ 3.00, 3.837, 5.230, 5.899, 5.889, 5.212, 0.280, 0.980463,   1.586 ],
#         [ 5.00, 2.831, 1.433, 4.664, 5.881, 4.664, 0.239, 0.972355,   0.774 ],
#     ),
#     Data(
#         70.0,
#         [ 0.05, 2.500, 0.386, 4.699, 2.561, 2.510, 1.586, 0.986665,  61.811 ],
#         [ 0.10, 2.167, 0.379, 4.594, 2.513, 2.417, 1.746, 0.998567,  29.213 ],
#         [ 0.30, 2.454, 0.380, 4.653, 2.535, 2.454, 1.589, 0.988022,  10.144 ],
#         [ 0.50, 2.496, 0.381, 4.695, 2.527, 2.484, 1.523, 0.984236,   6.159 ],
#         [ 1.00, 3.140, 1.355, 4.977, 2.140, 3.143, 4.975, 0.988389,   3.583 ],
#         [ 3.00, 1.204, 2.117, 0.418, 0.413, 3.560, 2.050, 0.977953,   0.550 ],
#         [ 5.00, 3.829, 1.600, 0.392, 1.621, 0.392, 0.914, 0.972840,   0.294 ],
#     ),
#     Data(
#         90.0,
#         [ 0.10, 3.657, 4.064, 1.675, 5.982, 3.840, 1.570, 0.991517,  29.195 ],
#         [ 0.30, 2.732, 5.796, 2.732, 1.371, 4.932, 2.671, 0.988476,  11.030 ],
#         [ 0.50, 3.469, 2.600, 3.469, 0.045, 5.746, 2.492, 0.990447,   8.075 ],
#         [ 1.00, 3.585, 2.740, 3.585, 0.500, 5.704, 2.318, 0.998151,   4.098 ],
#         [ 3.00, 1.949, 0.097, 5.876, 4.619, 1.921, 2.900, 0.991866,   1.034 ],
#         [ 5.00, 4.719, 5.807, 2.886, 3.786, 2.885, 2.533, 0.976706,   0.668 ],
#     ),
#     Data(
#         100.0,
#         [ 0.30, 2.693, 3.785, 5.865, 2.847, 2.780, 5.059, 0.993482,  12.030 ],
#         [ 0.50, 2.709, 3.766, 5.802, 2.772, 2.803, 4.907, 0.993053,   7.202 ],
#         [ 1.00, 4.013, 1.256, 4.013, 1.945, 2.180, 5.816, 0.995338,   3.249 ],
#         [ 3.00, 2.818, 3.610, 5.174, 2.083, 2.818, 3.484, 0.987684,   1.147 ],
#         [ 5.00, 5.211, 5.782, 3.150, 3.465, 3.150, 1.963, 0.984352,   0.733 ],
#     ),
#     Data(
#         200.0,
#         [ 0.30, 2.687, 5.925, 4.886, 3.865, 5.986, 4.631, 0.990272,  14.387 ],
#         [ 0.50, 2.447, 5.935, 4.943, 3.819, 5.946, 4.728, 0.995986,   8.490 ],
#         [ 1.00, 2.284, 5.986, 5.039, 3.861, 5.959, 4.892, 0.991255,   4.228 ],
#         [ 3.00, 6.918, 1.908, 6.846, 1.916, 6.013, 5.402, 0.986337,   2.099 ],
#         [ 5.00, 2.452, 1.837, 0.391, 0.811, 5.201, 1.981, 0.982241,   0.512 ],
#     ),
#     Data(
#         400.0,
#         [ 0.50, 4.708, 3.807, 5.800, 2.543, 1.351, 1.642, 0.974741,   7.549 ],
#         [ 1.00, 4.822, 3.814, 5.909, 2.524, 1.398, 1.525, 0.973938,   3.861 ],
#         [ 3.00, 5.073, 2.073, 5.989, 2.812, 0.491, 3.977, 0.980143,   1.226 ],
#         [ 5.00, 4.650, 1.995, 5.398, 2.591, 0.887, 2.836, 0.980586,   0.696 ],
#     ),
#     Data(
#         800.0,
#         [ 0.50, 4.791, 3.692, 4.785, 2.592, 5.890, 1.492, 0.955397,   9.846 ],
#         [ 1.00, 4.860, 3.923, 4.849, 2.747, 5.958, 1.697, 0.971226,   4.987 ],
#         [ 3.00, 4.791, 3.691, 4.791, 2.592, 5.890, 1.492, 0.969874,   1.662 ],
#         [ 5.00, 5.974, 1.814, 3.775, 2.149, 6.044, 2.564, 0.982299,   1.005 ],
#         [10.00, 5.829, 1.682, 3.630, 1.919, 5.829, 2.222, 0.981397,   0.487 ],
#         [30.00, 4.044, 1.160, 5.877, 0.217, 4.960, 5.880, 0.949322,   0.158 ],
#     ),
#     Data(
#         1000.0,
#         [ 0.50, 5.893, 3.692, 5.886, 2.592, 5.894, 1.492, 0.949219,  11.251 ],
#         [ 1.00, 5.933, 3.877, 5.920, 2.550, 5.936, 1.588, 0.972129,   5.662 ],
#         [ 3.00, 5.989, 4.020, 5.972, 2.793, 6.003, 1.721, 0.980045,   1.906 ],
#         [ 5.00, 6.011, 4.040, 5.997, 2.800, 6.021, 1.640, 0.980327,   1.148 ],
#         [10.00, 5.784, 1.657, 5.784, 1.898, 5.784, 2.169, 0.976926,   0.552 ],
#     ),
# ]

# gate_name = "e-m_cz"
# data = [
#     Data(
#         10.0,
#         [ 0.03, 0.365, 2.638, 5.862, 0.381, 4.763, 5.857, 0.999395, 116.611 ],
#         [ 0.05, 0.373, 2.646, 5.870, 0.363, 4.771, 5.867, 0.998456,  70.115 ],
#         [ 0.10, 0.388, 2.639, 5.886, 0.337, 4.786, 5.899, 0.993600,  35.206 ],
#         [ 0.30, 2.223, 6.058, 5.875, 0.432, 2.223, 1.103, 0.993271,  10.951 ],
#         [ 0.50, 4.963, 4.210, 2.214, 3.107, 1.284, 4.856, 0.987831,   5.386 ],
#         [ 1.00, 2.239, 0.231, 2.239, 5.013, 5.897, 6.014, 0.977206,   3.303 ],
#         [ 3.00, 4.331, 2.662, 5.902, 2.023, 4.331, 1.205, 0.921807,   1.545 ],
#         [ 5.00, 4.669, 5.890, 5.280, 2.225, 1.004, 3.447, 0.851058,   0.705 ],
#     ),
#     Data(
#         30.0,
#         [ 0.03, 2.621, 1.492, 2.546, 5.890, 2.597, 3.691, 0.993200,  82.377 ],
#         [ 0.05, 2.542, 0.242, 2.414, 4.704, 2.501, 2.829, 0.999439,  47.478 ],
#         [ 0.10, 2.585, 0.304, 2.585, 4.686, 2.585, 2.785, 0.999315,  24.684 ],
#         [ 0.30, 2.199, 1.213, 2.238, 2.241, 2.238, 3.222, 0.995612,   7.083 ],
#         [ 0.50, 4.989, 5.881, 3.156, 4.057, 4.989, 2.236, 0.996962,   8.361 ],
#         [ 1.00, 0.437, 5.027, 3.186, 0.312, 5.935, 5.002, 0.992351,   3.043 ],
#         [ 3.00, 3.142, 3.829, 2.454, 4.516, 3.142, 5.203, 0.985784,   0.954 ],
#         [ 5.00, 2.687, 4.877, 5.044, 2.804, 5.830, 2.922, 0.967081,   0.863 ],
#         [10.00, 2.225, 0.393, 4.058, 5.890, 2.225, 4.669, 0.954124,   0.276 ],
#         [30.00, 1.027, 6.198, 1.027, 4.694, 1.027, 3.114, 0.701256,   0.033 ],
#     ),
#     Data(
#         50.0,
#         [ 0.03, 3.238, 1.968, 3.148, 0.159, 3.142, 4.549, 0.997099, 101.090 ],
#         [ 0.05, 3.137, 1.728, 3.141, 6.127, 3.221, 4.319, 0.997577,  60.466 ],
#         [ 0.10, 2.507, 0.361, 5.805, 1.404, 0.308, 6.010, 0.996841,  27.438 ],
#         [ 0.30, 3.155, 4.079, 3.155, 2.226, 3.155, 0.371, 0.998515,  10.043 ],
#         [ 0.50, 5.011, 1.260, 2.262, 5.848, 5.011, 4.149, 0.998739,   7.820 ],
#         [ 1.00, 2.195, 2.076, 4.027, 3.142, 2.195, 4.207, 0.998760,   2.679 ],
#         [ 3.00, 5.072, 2.666, 0.359, 3.500, 5.857, 2.080, 0.992163,   1.198 ],
#         [ 5.00, 5.105, 2.749, 1.963, 5.105, 5.105, 1.178, 0.962925,   0.777 ],
#         [10.00, 2.458, 0.535, 2.452, 2.534, 2.456, 4.295, 0.980513,   0.234 ],
#     ),
#     Data(
#         70.0,
#         [ 0.03, 5.848, 4.708, 3.099, 3.142, 5.848, 1.575, 0.998902, 156.978 ],
#         [ 0.05, 5.889, 6.130, 3.185, 4.516, 5.889, 2.902, 0.999901,  95.257 ],
#         [ 0.10, 5.858, 3.335, 3.263, 1.767, 5.860, 0.200, 0.999855,  47.684 ],
#         [ 0.30, 3.589, 2.295, 3.477, 0.462, 3.694, 5.018, 0.997677,  11.417 ],
#         [ 0.50, 1.295, 4.982, 3.134, 0.438, 1.301, 2.173, 0.996697,   3.647 ],
#         [ 1.00, 1.360, 1.361, 3.241, 3.114, 1.272, 4.950, 0.997401,   1.870 ],
#         [ 3.00, 5.868, 5.052, 1.156, 4.319, 5.868, 3.588, 0.997808,   1.368 ],
#         [ 5.00, 4.543, 4.500, 3.856, 5.198, 4.543, 5.911, 0.993162,   0.824 ],
#         [10.00, 2.841, 5.720, 2.841, 2.807, 2.840, 6.091, 0.974609,   0.271 ],
#     ),
#     Data(
#         90.0,
#         [ 0.10, 3.184, 6.010, 4.559, 0.589, 3.184, 1.452, 0.998948,  34.783 ],
#         [ 0.30, 3.666, 4.800, 3.694, 3.686, 3.688, 2.587, 0.998053,  11.723 ],
#         [ 0.50, 3.799, 6.176, 3.821, 4.785, 3.819, 3.412, 0.995674,   7.282 ],
#         [ 1.00, 3.705, 3.847, 3.705, 4.790, 3.706, 5.736, 0.987893,   3.539 ],
#         [ 3.00, 1.721, 3.055, 3.780, 5.235, 1.725, 1.134, 0.990829,   0.767 ],
#         [ 5.00, 5.429, 0.238, 6.037, 1.345, 3.449, 0.817, 0.984777,   0.950 ],
#     ),
#     Data(
#         100.0,
#         [ 0.10, 4.490, 2.000, 4.431, 0.144, 4.422, 4.531, 0.998410,  42.473 ],
#         [ 0.30, 4.429, 0.269, 4.429, 4.687, 4.429, 2.282, 0.999149,  14.097 ],
#         [ 0.50, 3.232, 4.104, 5.065, 4.974, 3.232, 5.844, 0.999608,   7.340 ],
#         [ 1.00, 3.250, 0.424, 5.083, 1.309, 3.250, 2.194, 0.998436,   3.687 ],
#         [ 3.00, 1.996, 3.597, 4.352, 5.890, 1.996, 1.901, 0.993341,   0.885 ],
#         [ 5.00, 4.314, 5.108, 5.155, 4.598, 5.997, 5.189, 0.994871,   0.985 ],
#     ),
#     Data(
#         200.0,
#         [ 0.30, 1.669, 3.142, 6.087, 1.669, 1.669, 0.196, 0.994165,  10.000 ],
#         [ 0.50, 1.629, 6.059, 5.960, 4.615, 1.625, 3.169, 0.995264,   5.866 ],
#         [ 1.00, 5.103, 2.307, 6.084, 3.141, 5.103, 3.976, 0.996329,   5.185 ],
#         [ 3.00, 2.164, 1.261, 5.109, 3.141, 2.164, 5.023, 0.994902,   1.001 ],
#         [ 5.00, 2.696, 4.322, 6.062, 0.347, 2.696, 2.653, 0.995406,   0.729 ],
#     ),
#     Data(
#         400.0,
#         [ 0.50, 3.492, 4.663, 6.437, 6.039, 2.020, 1.668, 0.960393,   7.607 ],
#         [ 1.00, 3.376, 3.177, 6.374, 4.598, 2.044, 0.178, 0.963885,   3.754 ],
#         [ 3.00, 2.614, 6.352, 6.148, 4.909, 2.614, 3.465, 0.970401,   1.207 ],
#         [ 5.00, 3.392, 0.148, 8.491, 2.159, 3.413, 4.173, 0.994045,   0.974 ],
#     ),
# ]

gate_name = "e-n-m_ccz"
data = [
    Data(
        10.0,
        [ 0.03, 4.493, 3.482, 4.495, 1.541, 4.495, 5.875, 0.998546, 143.054 ],
        [ 0.05, 4.524, 0.362, 4.537, 4.767, 4.537, 2.824, 0.997783,  86.565 ],
        [ 0.10, 4.661, 1.659, 4.619, 6.150, 4.619, 4.562, 0.995717,  44.243 ],
        [ 0.30, 0.196, 6.087, 4.614, 3.142, 0.196, 0.196, 0.980361,   8.756 ],
        [ 0.50, 4.608, 4.713, 6.081, 3.139, 4.608, 1.574, 0.985763,   9.738 ],
        [ 1.00, 1.402, 0.217, 5.819, 4.679, 1.422, 3.056, 0.973927,   2.751 ],
        [ 3.00, 2.651, 2.304, 2.630, 3.768, 2.704, 5.120, 0.930997,   0.847 ],
    ),
    Data(
        30.0,
        [ 0.03, 2.923, 3.135, 2.923, 3.141, 0.698, 3.149, 0.990937,  69.440 ],
        [ 0.05, 4.636, 3.125, 1.691, 3.146, 0.218, 3.153, 0.990900,  41.670 ],
        [ 0.10, 6.109, 4.599, 0.218, 4.628, 0.218, 4.616, 0.990646,  20.836 ],
        [ 0.30, 0.232, 0.421, 0.232, 5.908, 6.122, 0.150, 0.988868,   6.989 ],
        [ 0.50, 1.751, 3.052, 6.169, 1.673, 1.751, 0.281, 0.987060,   6.157 ],
        [ 1.00, 6.058, 4.291, 1.640, 3.313, 1.640, 1.821, 0.984778,   2.973 ],
        [ 3.00, 6.059, 5.865, 1.647, 0.458, 1.646, 1.629, 0.978338,   0.992 ],
        [ 5.00, 4.600, 3.213, 3.128, 1.677, 4.600, 0.127, 0.952451,   0.785 ],
    ),
    Data(
        50.0,
        [ 0.05, 4.714, 3.134, 3.241, 3.144, 0.296, 3.146, 0.990916,  52.527 ],
        [ 0.10, 4.714, 3.123, 3.241, 3.145, 0.296, 3.157, 0.990789,  26.263 ],
        [ 0.30, 6.188, 0.051, 1.770, 0.206, 0.297, 0.333, 0.990192,   8.758 ],
        [ 0.50, 6.189,-0.054, 1.772, 0.216, 0.299, 0.427, 0.988829,   5.258 ],
        [ 1.00, 1.779, 5.986, 6.197, 0.217, 0.307, 0.277, 0.982095,   2.637 ],
        [ 3.00, 4.632, 6.068, 4.576, 4.612, 4.583, 3.163, 0.987173,   1.463 ],
        [ 5.00, 4.639, 3.176, 3.167, 4.589, 7.112, 3.133, 0.975640,   0.886 ],
    ),
    Data(
        70.0,
        [ 0.05, 3.865, 2.177,-0.107, 6.043, 5.787, 2.186, 0.990912,  60.768 ],
        [ 0.10, 5.816, 6.036,-0.074, 2.242, 3.843, 6.055, 0.990822,  30.511 ],
        [ 0.30, 6.168, 3.122, 0.277, 3.119, 3.221, 3.184, 0.989872,  10.256 ],
        [ 0.50, 4.694, 4.477, 4.694, 4.640, 0.276, 4.726, 0.988332,   6.153 ],
        [ 1.00, 1.757, 6.015, 6.175, 0.066, 1.747, 0.398, 0.989317,   3.084 ],
        [ 3.00, 6.088, 4.315, 6.088, 0.075, 6.061, 2.090, 0.972546,   1.935 ],
        [ 5.00, 4.774, 5.894, 6.249,-0.043, 1.930, 0.627, 0.985230,   0.825 ],
    ),
    Data(
        90.0,
        [ 0.10, 4.287, 6.072, 2.323, 6.087, 4.287, 6.102, 0.990887,  34.684 ],
        [ 0.30, 6.250, 2.110, 4.289, 2.161, 0.359, 2.208, 0.990127,  11.563 ],
        [ 0.50, 6.081, 4.549, 4.612, 4.644, 0.196, 4.650, 0.988650,   6.932 ],
        [ 1.00, 1.664, 6.151, 6.085, 0.096, 3.139, 0.223, 0.984872,   3.466 ],
        [ 3.00, 4.622, 1.684, 4.622, 2.910, 6.092, 1.886, 0.981111,   1.627 ],
    ),
    Data(
        100.0,
        [ 0.10, 5.784, 0.204, 5.784, 0.231,-0.106, 4.081, 0.990885,  36.484 ],
        [ 0.30, 6.195, 0.322, 3.348, 0.385, 1.925, 0.471, 0.990632,  12.168 ],
        [ 0.50, 6.193, 0.304, 4.770, 0.410, 0.499, 0.464, 0.989049,   7.297 ],
        [ 1.00, 6.192, 1.626, 4.768, 1.844, 0.498, 1.978, 0.983371,   3.647 ],
        [ 3.00, 4.652, 3.010, 6.076, 1.816, 4.652, 0.622, 0.982892,   1.632 ],
    ),
    Data(
        200.0,
        [ 0.30, 5.988, 2.266, 5.988, 2.269, 4.090, 2.337, 0.990726,  17.048 ],
        [ 0.50, 5.987, 2.249, 5.987, 2.254, 4.089, 2.370, 0.990311,  10.226 ],
        [ 1.00, 6.310, 0.357, 6.310, 0.244, 3.463, 0.577, 0.989240,   5.119 ],
        [ 3.00, 6.316, 6.167, 6.316, 5.856, 3.469, 0.544, 0.975350,   1.708 ],
    ),
]

P = pd.Plotter.new(nrows=2, sharex=True, as_plotarray=True)
for (k, d) in enumerate(data):
    P[0].loglog(
        d.data[:, 0], 1 - d.data[:, 7],
        marker=".", linestyle="-", color=f"C{k % 10}",
        label=f"$\\omega / 2 \\pi = {d.trap_freq:.1f}$ kHz"
    )
    P[1].loglog(
        d.data[:, 0], d.data[:, 8],
        marker=".", linestyle="-", color=f"C{k % 10}",
    )
(
    P
    [0]
    .axhline(1 - 0.995, linestyle="--", color="0.5")
    .ggrid()
    .set_ylabel("$1 - \\mathcal{F}$")
    .set_title(gate_name.replace("_", " "))
    .legend(
        fontsize="xx-small",
        frameon=False,
        loc="upper left",
        bbox_to_anchor=(1.0, 1.0),
        framealpha=1.0,
    )
    [1]
    .ggrid()
    .set_ylabel("Gate time [ms]")
    .set_xlabel("Rabi freq. [kHz]")
    .savefig(outdir.joinpath(f"{gate_name}_freq_scan.png"))
    .show()
    .close()
)


